<!DOCTYPE html>

<html>
<head>
<title>The Z-Machine Standards Document</title>
<link rel="stylesheet" type="text/css" href="zspec.css">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
</head>

<body>

<hr>

<img class="icon" src="icon14.gif" alt="">

<h1>14. Complete table of opcodes</h1>

<hr>

<p><a href="#2OP">2OP</a> /
   <a href="#1OP">1OP</a> /
   <a href="#0OP">0OP</a> /
   <a href="#VAR">VAR</a> /
   <a href="#EXT">EXT</a>
</p>
<p>14.1 <a href="#14.1">Contents</a> / 
   14.2 <a href="#14.2">Out of range opcodes</a> /
   <a href="#reading"><em>Reading the table</em></a> /
   <a href="#inform"><em>Inform assembly language</em></a>
</p>

<hr>


<table class="opcodes" id="2OP">

<caption><strong>Two-operand opcodes 2OP</strong></caption>

<tr><td>   St</td><td>  Br</td><td>  Opcode</td><td> Hex </td><td> V  </td><td>Inform name and syntax  </td><td>ZIL name</td><td>Link</td></tr>
<tr><td>     </td><td>    </td><td>  ------</td><td>   0 </td><td> ---</td><td>---</td><td></td><td></td></tr>

<tr><td>     </td><td>  * </td><td>  2OP:1 </td><td>   1 </td><td>    </td>
    <td>je              a b c d ?(label)</td><td>EQUAL?</td><td><a href="sect15.html#je"><strong>je              </strong></a></td>
</tr>

<tr><td>     </td><td>  * </td><td>  2OP:2 </td><td>   2 </td><td>    </td>
    <td>jl              a b ?(label)</td><td>LESS?</td><td><a href="sect15.html#jl"><strong>jl              </strong></a></td>
</tr>

<tr><td>     </td><td>  * </td><td>  2OP:3 </td><td>   3 </td><td>    </td><td>jg              a b ?(label)</td>
    <td>GRTR?</td><td><a href="sect15.html#jg"><strong>jg              </strong></a></td>
</tr>

<tr><td>     </td><td>  * </td><td>  2OP:4 </td><td>   4 </td><td>    </td><td>dec_chk         (variable) value ?(label)</td>
    <td>DLESS?</td><td><a href="sect15.html#dec_chk"><strong>dec_chk         </strong></a></td>
</tr>

<tr><td>     </td><td>  * </td><td>  2OP:5 </td><td>   5 </td><td>    </td><td>inc_chk         (variable) value ?(label)</td>
    <td>IGRTR?</td><td><a href="sect15.html#inc_chk"><strong>inc_chk         </strong></a></td>
</tr>

<tr><td>     </td><td>  * </td><td>  2OP:6 </td><td>   6 </td><td>    </td><td>jin             obj1 obj2 ?(label)</td>
    <td>IN?</td><td><a href="sect15.html#jin"><strong>jin             </strong></a></td>
</tr>

<tr><td>     </td><td>  * </td><td>  2OP:7 </td><td>   7 </td><td>    </td><td>test            bitmap flags ?(label)</td>
    <td>BTST</td><td><a href="sect15.html#test"><strong>test            </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:8 </td><td>   8 </td><td>    </td><td>or              a b -> (result)</td>
    <td>BOR</td><td><a href="sect15.html#or"><strong>or              </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:9 </td><td>   9 </td><td>    </td><td>and             a b -> (result)</td>
    <td>BAND</td><td><a href="sect15.html#and"><strong>and             </strong></a></td>
</tr>

<tr><td>     </td><td>  * </td><td>  2OP:10</td><td>   A </td><td>    </td><td>test_attr       object attribute ?(label)</td>
    <td>FSET?</td><td><a href="sect15.html#test_attr"><strong>test_attr       </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  2OP:11</td><td>   B </td><td>    </td><td>set_attr        object attribute</td>
    <td>FSET</td><td><a href="sect15.html#set_attr"><strong>set_attr        </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  2OP:12</td><td>   C </td><td>    </td><td>clear_attr      object attribute</td>
    <td>FCLEAR</td><td><a href="sect15.html#clear_attr"><strong>clear_attr      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  2OP:13</td><td>   D </td><td>    </td><td>store           (variable) value</td>
    <td>SET</td><td><a href="sect15.html#store"><strong>store           </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  2OP:14</td><td>   E </td><td>    </td><td>insert_obj      object destination</td>
    <td>MOVE</td><td><a href="sect15.html#insert_obj"><strong>insert_obj      </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:15</td><td>   F </td><td>    </td><td>loadw           array word-index -> (result)</td>
    <td>GET</td><td><a href="sect15.html#loadw"><strong>loadw           </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:16</td><td>  10 </td><td>    </td><td>loadb           array byte-index -> (result)</td>
    <td>GETB</td><td><a href="sect15.html#loadb"><strong>loadb           </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:17</td><td>  11 </td><td>    </td><td>get_prop        object property -> (result)</td>
    <td>GETP</td><td><a href="sect15.html#get_prop"><strong>get_prop        </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:18</td><td>  12 </td><td>    </td><td>get_prop_addr   object property -> (result)</td>
    <td>GETPT</td><td><a href="sect15.html#get_prop_addr"><strong>get_prop_addr   </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:19</td><td>  13 </td><td>    </td><td>get_next_prop   object property -> (result)</td>
    <td>NEXTP</td><td><a href="sect15.html#get_next_prop"><strong>get_next_prop   </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:20</td><td>  14 </td><td>    </td><td>add             a b -> (result)</td>
    <td>ADD</td><td><a href="sect15.html#add"><strong>add             </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:21</td><td>  15 </td><td>    </td><td>sub             a b -> (result)</td>
    <td>SUB</td><td><a href="sect15.html#sub"><strong>sub             </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:22</td><td>  16 </td><td>    </td><td>mul             a b -> (result)</td>
    <td>MUL</td><td><a href="sect15.html#mul"><strong>mul             </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:23</td><td>  17 </td><td>    </td><td>div             a b -> (result)</td>
    <td>DIV</td><td><a href="sect15.html#div"><strong>div             </strong></a></td></tr>

<tr><td>   * </td><td>    </td><td>  2OP:24</td><td>  18 </td><td>    </td><td>mod             a b -> (result)</td>
    <td>MOD</td><td><a href="sect15.html#mod"><strong>mod             </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  2OP:25</td><td>  19 </td><td> 4  </td><td>call_2s         routine arg1 -> (result)</td>
    <td>CALL2</td><td><a href="sect15.html#call_2s"><strong>call_2s         </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  2OP:26</td><td>  1A </td><td> 5  </td><td>call_2n         routine arg1</td>
    <td>ICALL2</td><td><a href="sect15.html#call_2n"><strong>call_2n         </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  2OP:27</td><td>  1B </td><td> 5  </td><td>set_colour      foreground background</td>
    <td>COLOR</td><td><a href="sect15.html#set_colour"><strong>set_colour</strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 6  </td><td>set_colour      foreground background window</td>
    <td>COLOR</td><td><a href="sect15.html#set_colour"><strong>set_colour</strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  2OP:28</td><td>  1C </td><td>5/6 </td><td>throw           value stack-frame</td>
    <td>THROW</td><td><a href="sect15.html#throw"><strong>throw           </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  ------</td><td>  1D </td><td> ---</td><td>---</td><td></td><td></td></tr>
<tr><td>     </td><td>    </td><td>  ------</td><td>  1E </td><td> ---</td><td>---</td><td></td><td></td></tr>
<tr><td>     </td><td>    </td><td>  ------</td><td>  1F </td><td> ---</td><td>---</td><td></td><td></td></tr>
<tr><td colspan="8" class="note">Opcode numbers 32 to 127: other forms of 2OP with different types.</td></tr>
</table>


<table class="opcodes" id="1OP">

<caption><strong>One-operand opcodes 1OP</strong></caption>

<tr><td>   St</td><td>  Br</td><td>  Opcode</td><td> Hex </td><td> V  </td><td>Inform name and syntax  </td><td>ZIL name</td><td>Link</td></tr>

<tr><td>     </td><td>  * </td><td>  1OP:128</td><td>  0 </td><td>    </td><td>jz              a ?(label)</td>
    <td>ZERO?</td><td><a href="sect15.html#jz"><strong>jz              </strong></a></td>
</tr>

<tr><td>   * </td><td>  * </td><td>  1OP:129</td><td>  1 </td><td>    </td><td>get_sibling     object -> (result) ?(label)</td>
    <td>NEXT?</td><td><a href="sect15.html#get_sibling"><strong>get_sibling     </strong></a></td>
</tr>

<tr><td>   * </td><td>  * </td><td>  1OP:130</td><td>  2 </td><td>    </td><td>get_child       object -> (result) ?(label)</td>
    <td>FIRST?</td><td><a href="sect15.html#get_child"><strong>get_child       </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  1OP:131</td><td>  3 </td><td>    </td><td>get_parent      object -> (result)</td>
    <td>LOC</td><td><a href="sect15.html#get_parent"><strong>get_parent      </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  1OP:132</td><td>  4 </td><td>    </td><td>get_prop_len    property-address -> (result)</td>
    <td>PTSIZE</td><td><a href="sect15.html#get_prop_len"><strong>get_prop_len    </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  1OP:133</td><td>  5 </td><td>    </td><td>inc             (variable)</td>
    <td>INC</td><td><a href="sect15.html#inc"><strong>inc             </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  1OP:134</td><td>  6 </td><td>    </td><td>dec             (variable)</td>
    <td>DEC</td><td><a href="sect15.html#dec"><strong>dec             </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  1OP:135</td><td>  7 </td><td>    </td><td>print_addr      byte-address-of-string</td>
    <td>PRINTB</td><td><a href="sect15.html#print_addr"><strong>print_addr      </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  1OP:136</td><td>  8 </td><td> 4  </td><td>call_1s         routine -> (result)</td>
    <td>CALL1</td><td><a href="sect15.html#call_1s"><strong>call_1s         </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  1OP:137</td><td>  9 </td><td>    </td><td>remove_obj      object</td>
    <td>REMOVE</td><td><a href="sect15.html#remove_obj"><strong>remove_obj      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  1OP:138</td><td>  A </td><td>    </td><td>print_obj       object</td>
    <td>PRINTD</td><td><a href="sect15.html#print_obj"><strong>print_obj       </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  1OP:139</td><td>  B </td><td>    </td><td>ret             value</td>
    <td>RETURN</td><td><a href="sect15.html#ret"><strong>ret             </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  1OP:140</td><td>  C </td><td>    </td><td>jump            ?(label)</td>
    <td>JUMP</td><td><a href="sect15.html#jump"><strong>jump            </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  1OP:141</td><td>  D </td><td>    </td><td>print_paddr     packed-address-of-string</td>
    <td>PRINT</td><td><a href="sect15.html#print_paddr"><strong>print_paddr     </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  1OP:142</td><td>  E </td><td>    </td><td>load            (variable) -> (result)</td>
    <td>VALUE</td><td><a href="sect15.html#load"><strong>load            </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  1OP:143</td><td>  F </td><td>1/4 </td><td>not             value -> (result)</td>
    <td>BCOM</td><td><a href="sect15.html#not"><strong>not             </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 5  </td><td>call_1n         routine</td>
    <td>ICALL1</td><td><a href="sect15.html#call_1n"><strong>call_1n         </strong></a></td>
</tr>

<tr><td colspan="8" class="note">Opcode numbers 144 to 175: other forms of 1OP with different types.</td></tr>

</table>



<table class="opcodes" id="0OP">

<caption><strong>Zero-operand opcodes 0OP</strong></caption>

<tr><td>   St</td><td>  Br</td><td>  Opcode</td><td> Hex </td><td> V  </td><td>Inform name and syntax  </td><td>ZIL name</td><td>Link</td></tr>

<tr><td>     </td><td>    </td><td>  0OP:176</td><td>  0 </td><td>    </td><td>rtrue</td>
    <td>RTRUE</td><td><a href="sect15.html#rtrue"><strong>rtrue</strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:177</td><td>  1 </td><td>    </td><td>rfalse</td>
    <td>RFALSE</td><td><a href="sect15.html#rfalse"><strong>rfalse</strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:178</td><td>  2 </td><td>    </td>
    <td>print           (literal-string)</td><td>PRINTI</td><td><a href="sect15.html#print"><strong>print           </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:179</td><td>  3 </td><td>    </td>
    <td>print_ret       (literal-string)</td><td>PRINTR</td><td><a href="sect15.html#print_ret"><strong>print_ret       </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:180</td><td>  4 </td><td>1/- </td><td>nop</td><td>NOOP</td><td><a href="sect15.html#nop"><strong>nop</strong></a></td></tr>

<tr><td>     </td><td>  * </td><td>  0OP:181</td><td>  5 </td><td> 1  </td>
    <td>save            ?(label)</td><td>SAVE</td><td><a href="sect15.html#save"><strong>save            </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>        </td><td>     </td><td> 4  </td><td>save            -> (result)</td>
    <td>SAVE</td><td><a href="sect15.html#save"><strong>save            </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 5  </td><td>[illegal]</td><td></td><td></td></tr>

<tr><td>     </td><td>  * </td><td>  0OP:182</td><td>  6 </td><td> 1  </td><td>restore         ?(label)</td>
    <td>RESTORE</td><td><a href="sect15.html#restore"><strong>restore         </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>        </td><td>     </td><td> 4  </td><td>restore         -> (result)</td>
    <td>RESTORE</td><td><a href="sect15.html#restore"><strong>restore         </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 5  </td><td>[illegal]</td><td></td><td></td></tr>

<tr><td>     </td><td>    </td><td>  0OP:183</td><td>  7 </td><td>    </td><td>restart</td>
    <td>RESTART</td><td><a href="sect15.html#restart"><strong>restart</strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:184</td><td>  8 </td><td>    </td><td>ret_popped</td>
    <td>RSTACK</td><td><a href="sect15.html#ret_popped"><strong>ret_popped</strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:185</td><td>  9 </td><td> 1  </td><td>pop</td>
    <td>FSTACK</td><td><a href="sect15.html#pop"><strong>pop</strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>        </td><td>     </td><td>5/6 </td><td>catch           -> (result)</td>
    <td>CATCH</td><td><a href="sect15.html#catch"><strong>catch           </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:186</td><td>  A </td><td>    </td><td>quit</td>
    <td>QUIT</td><td><a href="sect15.html#quit"><strong>quit</strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:187</td><td>  B </td><td>    </td><td>new_line</td>
    <td>CRLF</td><td><a href="sect15.html#new_line"><strong>new_line</strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:188</td><td>  C </td><td> 3  </td><td>show_status</td>
    <td>USL</td><td><a href="sect15.html#show_status"><strong>show_status</strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 4  </td><td>[illegal]</td><td></td><td></td></tr>

<tr><td>     </td><td>  * </td><td>  0OP:189</td><td>  D </td><td> 3  </td><td>verify          ?(label)</td>
    <td>VERIFY</td><td><a href="sect15.html#verify"><strong>verify          </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  0OP:190</td><td>  E </td><td> 5  </td><td>[first byte of extended opcode]</td>
    <td>EXTOP</td><td><a href="sect15.html#extended"><strong>extended</strong></a></td>
</tr>

<tr><td>     </td><td>  * </td><td>  0OP:191</td><td>  F </td><td>5/- </td><td>piracy          ?(label)</td>
    <td>ORIGINAL?</td><td><a href="sect15.html#piracy"><strong>piracy          </strong></a></td>
</tr>

<tr><td colspan="8" class="note">Opcode numbers 192 to 223: VAR forms of 2OP:0 to 2OP:31.</td></tr>

</table>

<table class="opcodes" id="VAR">

<caption><strong>Variable-operand opcodes VAR</strong></caption>

<tr><td>   St</td><td>  Br</td><td>  Opcode</td><td> Hex </td><td> V  </td><td>Inform name and syntax  </td><td>ZIL name</td><td>Link</td></tr>

<tr><td>   * </td><td>    </td><td>  VAR:224</td><td>  0 </td><td> 1  </td><td>call            routine ...0 to 3 args... -> (result)</td>
    <td>CALL</td><td><a href="sect15.html#call"><strong>call            </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>        </td><td>     </td><td> 4  </td><td>call_vs         routine ...0 to 3 args... -> (result)</td>
    <td>CALL</td><td><a href="sect15.html#call_vs"><strong>call_vs         </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:225</td><td>  1 </td><td>    </td><td>storew          array word-index value</td>
    <td>PUT</td><td><a href="sect15.html#storew"><strong>storew          </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:226</td><td>  2 </td><td>    </td><td>storeb          array byte-index value</td>
    <td>PUTB</td><td><a href="sect15.html#storeb"><strong>storeb          </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:227</td><td>  3 </td><td>    </td><td>put_prop        object property value</td>
    <td>PUTP</td><td><a href="sect15.html#put_prop"><strong>put_prop        </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:228</td><td>  4 </td><td> 1  </td><td>sread           text parse</td>
    <td>READ</td><td><a href="sect15.html#sread"><strong>sread           </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 4  </td><td>sread           text parse time routine</td>
    <td>READ</td><td><a href="sect15.html#sread"><strong>sread           </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>        </td><td>     </td><td> 5  </td><td>aread           text parse time routine -> (result)</td>
    <td>READ</td><td><a href="sect15.html#aread"><strong>aread           </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:229</td><td>  5 </td><td>    </td><td>print_char      output-character-code</td>
    <td>PRINTC</td><td><a href="sect15.html#print_char"><strong>print_char      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:230</td><td>  6 </td><td>    </td><td>print_num       value</td>
    <td>PRINTN</td><td><a href="sect15.html#print_num"><strong>print_num       </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  VAR:231</td><td>  7 </td><td>    </td><td>random          range -> (result)</td>
    <td>RANDOM</td><td><a href="sect15.html#random"><strong>random          </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:232</td><td>  8 </td><td>    </td><td>push            value</td>
    <td>PUSH</td><td><a href="sect15.html#push"><strong>push            </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:233</td><td>  9 </td><td> 1  </td><td>pull            (variable)</td>
    <td>POP</td><td><a href="sect15.html#pull"><strong>pull            </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>        </td><td>     </td><td> 6  </td><td>pull            stack -> (result)</td>
    <td>POP</td><td><a href="sect15.html#pull"><strong>pull            </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:234</td><td>  A </td><td> 3  </td><td>split_window    lines</td>
    <td>SPLIT</td><td><a href="sect15.html#split_window"><strong>split_window    </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:235</td><td>  B </td><td> 3  </td><td>set_window      window</td>
    <td>SCREEN</td><td><a href="sect15.html#set_window"><strong>set_window      </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  VAR:236</td><td>  C </td><td> 4  </td><td>call_vs2        routine ...0 to 7 args... -> (result)</td>
    <td>XCALL</td><td><a href="sect15.html#call_vs2"><strong>call_vs2        </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:237</td><td>  D </td><td> 4  </td><td>erase_window    window</td>
    <td>CLEAR</td><td><a href="sect15.html#erase_window"><strong>erase_window    </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:238</td><td>  E </td><td>4/- </td><td>erase_line      value</td>
    <td>ERASE</td><td><a href="sect15.html#erase_line"><strong>erase_line      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 6  </td><td>erase_line      pixels</td>
    <td>ERASE</td><td><a href="sect15.html#erase_line"><strong>erase_line      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:239</td><td>  F </td><td> 4  </td><td>set_cursor      line column</td>
    <td>CURSET</td><td><a href="sect15.html#set_cursor"><strong>set_cursor      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 6  </td><td>set_cursor      line column window</td>
    <td>CURSET</td><td><a href="sect15.html#set_cursor"><strong>set_cursor      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:240</td><td> 10 </td><td>4/6 </td><td>get_cursor      array</td>
    <td>CURGET</td><td><a href="sect15.html#get_cursor"><strong>get_cursor      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:241</td><td> 11 </td><td> 4  </td><td>set_text_style  style</td>
    <td>HLIGHT</td><td><a href="sect15.html#set_text_style"><strong>set_text_style  </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:242</td><td> 12 </td><td> 4  </td><td>buffer_mode     flag</td>
    <td>BUFOUT</td><td><a href="sect15.html#buffer_mode"><strong>buffer_mode     </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:243</td><td> 13 </td><td> 3  </td><td>output_stream   number</td>
    <td>DIROUT</td><td><a href="sect15.html#output_stream"><strong>output_stream   </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 5  </td><td>output_stream   number table</td>
    <td>DIROUT</td><td><a href="sect15.html#output_stream"><strong>output_stream   </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>        </td><td>     </td><td> 6  </td><td>output_stream   number table width</td>
    <td>DIROUT</td><td><a href="sect15.html#output_stream"><strong>output_stream   </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:244</td><td> 14 </td><td> 3  </td><td>input_stream    number</td>
    <td>DIRIN</td><td><a href="sect15.html#input_stream"><strong>input_stream    </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:245</td><td> 15 </td><td>5/3 </td><td>sound_effect    number effect volume</td>
    <td>SOUND</td><td><a href="sect15.html#sound_effect"><strong>sound_effect    </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>         </td><td>    </td><td>5</td><td>sound_effect    number effect volume routine</td>
    <td>SOUND</td><td><a href="sect15.html#sound_effect"><strong>sound_effect    </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  VAR:246</td><td> 16 </td><td> 4  </td><td>read_char       1 time routine -> (result)</td>
    <td>INPUT</td><td><a href="sect15.html#read_char"><strong>read_char       </strong></a></td>
</tr>

<tr><td>   * </td><td>   *</td><td>  VAR:247</td><td> 17 </td><td> 4  </td><td>scan_table      x table len form -> (result) ?(label)</td>
    <td>INTBL?</td><td><a href="sect15.html#scan_table"><strong>scan_table      </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  VAR:248</td><td> 18 </td><td>5/6 </td><td>not             value -> (result)</td>
    <td>BCOM</td><td><a href="sect15.html#not"><strong>not             </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:249</td><td> 19 </td><td> 5  </td><td>call_vn         routine ...up to 3 args...</td>
    <td>ICALL</td><td><a href="sect15.html#call_vn"><strong>call_vn         </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:250</td><td> 1A </td><td> 5  </td><td>call_vn2        routine ...up to 7 args...</td>
    <td>IXCALL</td><td><a href="sect15.html#call_vn2"><strong>call_vn2        </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:251</td><td> 1B </td><td> 5  </td><td>tokenise        text parse dictionary flag</td>
    <td>LEX</td><td><a href="sect15.html#tokenise"><strong>tokenise        </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:252</td><td> 1C </td><td> 5  </td><td>encode_text     zscii-text length from coded-text</td>
    <td>ZWSTR</td><td><a href="sect15.html#encode_text"><strong>encode_text     </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:253</td><td> 1D </td><td> 5  </td><td>copy_table      first second size</td>
    <td>COPYT</td><td><a href="sect15.html#copy_table"><strong>copy_table      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  VAR:254</td><td> 1E </td><td> 5  </td><td>print_table     zscii-text width height skip</td>
    <td>PRINTT</td><td><a href="sect15.html#print_table"><strong>print_table     </strong></a></td>
</tr>

<tr><td>     </td><td>   *</td><td>  VAR:255</td><td> 1F </td><td> 5  </td><td>check_arg_count argument-number ?(label)</td>
    <td>ASSIGNED?</td><td><a href="sect15.html#check_arg_count"><strong>check_arg_count </strong></a></td>
</tr>

</table>


<table class="opcodes" id="EXT">

<caption><strong>Extended opcodes EXT</strong></caption>

<tr><td>   St</td><td>  Br</td><td>  Opcode</td><td> Hex </td><td> V  </td><td>Inform name and syntax  </td><td>ZIL name</td><td>Link</td></tr>

<tr><td>   * </td><td>    </td><td>  EXT:0 </td><td>   0 </td><td> 5  </td><td>save            table bytes name prompt -> (result)</td>
    <td>SAVE</td><td><a href="sect15.html#save"><strong>save            </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  EXT:1 </td><td>   1 </td><td> 5  </td><td>restore         table bytes name prompt -> (result)</td>
    <td>RESTORE</td><td><a href="sect15.html#restore"><strong>restore         </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  EXT:2 </td><td>   2 </td><td> 5  </td><td>log_shift       number places -> (result)</td>
    <td>SHIFT</td><td><a href="sect15.html#log_shift"><strong>log_shift       </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  EXT:3 </td><td>   3 </td><td>5/- </td><td>art_shift       number places -> (result)</td>
    <td>ASHIFT</td><td><a href="sect15.html#art_shift"><strong>art_shift       </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  EXT:4 </td><td>   4 </td><td> 5  </td><td>set_font        font -> (result)</td>
    <td>FONT</td><td><a href="sect15.html#set_font"><strong>set_font        </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:5 </td><td>   5 </td><td> 6  </td><td>draw_picture    picture-number y x</td>
    <td>DISPLAY</td><td><a href="sect15.html#draw_picture"><strong>draw_picture    </strong></a></td>
</tr>

<tr><td>     </td><td>   *</td><td>  EXT:6 </td><td>   6 </td><td> 6  </td><td>picture_data    picture-number array ?(label)</td>
    <td>PICINF</td><td><a href="sect15.html#picture_data"><strong>picture_data    </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:7 </td><td>   7 </td><td> 6  </td><td>erase_picture   picture-number y x</td>
    <td>DCLEAR</td><td><a href="sect15.html#erase_picture"><strong>erase_picture   </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:8 </td><td>   8 </td><td> 6  </td><td>set_margins     left right window</td>
    <td>MARGIN</td><td><a href="sect15.html#set_margins"><strong>set_margins     </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  EXT:9 </td><td>   9 </td><td> 5  </td><td>save_undo       -> (result)</td>
    <td>ISAVE</td><td><a href="sect15.html#save_undo"><strong>save_undo       </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  EXT:10</td><td>   A </td><td> 5  </td><td>restore_undo    -> (result)</td>
    <td>IRESTORE</td><td><a href="sect15.html#restore_undo"><strong>restore_undo    </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:11</td><td>   B </td><td>5/* </td><td>print_unicode   char-number</td>
    <td>PRINTU</td><td><a href="sect15.html#print_unicode"><strong>print_unicode   </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  EXT:12</td><td>   C </td><td>5/* </td><td>check_unicode   char-number -> (result)</td>
    <td>CHECKU</td><td><a href="sect15.html#check_unicode"><strong>check_unicode   </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  -------</td><td>  D </td><td> ---</td><td>---</td><td></td></tr>
<tr><td>     </td><td>    </td><td>  -------</td><td>  E </td><td> ---</td><td>---</td><td></td></tr>
<tr><td>     </td><td>    </td><td>  -------</td><td>  F </td><td> ---</td><td>---</td><td></td></tr>

<tr><td>     </td><td>    </td><td>  EXT:16</td><td>  10 </td><td> 6  </td><td>move_window     window y x</td>
    <td>WINPOS</td><td><a href="sect15.html#move_window"><strong>move_window     </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:17</td><td>  11 </td><td> 6  </td><td>window_size     window y x</td>
    <td>WINSIZE</td><td><a href="sect15.html#window_size"><strong>window_size     </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:18</td><td>  12 </td><td> 6  </td><td>window_style    window flags operation</td>
    <td>WINATTR</td><td><a href="sect15.html#window_style"><strong>window_style    </strong></a></td>
</tr>

<tr><td>   * </td><td>    </td><td>  EXT:19</td><td>  13 </td><td> 6  </td><td>get_wind_prop   window property-number -> (result)</td>
    <td>WINGET</td><td><a href="sect15.html#get_wind_prop"><strong>get_wind_prop   </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:20</td><td>  14 </td><td> 6  </td><td>scroll_window   window pixels</td>
    <td>SCROLL</td><td><a href="sect15.html#scroll_window"><strong>scroll_window   </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:21</td><td>  15 </td><td> 6  </td><td>pop_stack       items stack</td>
    <td>FSTACK</td><td><a href="sect15.html#pop_stack"><strong>pop_stack       </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:22</td><td>  16 </td><td> 6  </td><td>read_mouse      array</td>
    <td>MOUSE-INFO</td><td><a href="sect15.html#read_mouse"><strong>read_mouse      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:23</td><td>  17 </td><td> 6  </td><td>mouse_window    window</td>
    <td>MOUSE-LIMIT</td><td><a href="sect15.html#mouse_window"><strong>mouse_window    </strong></a></td>
</tr>

<tr><td>     </td><td>   *</td><td>  EXT:24</td><td>  18 </td><td> 6  </td><td>push_stack      value stack ?(label)</td>
    <td>XPUSH</td><td><a href="sect15.html#push_stack"><strong>push_stack      </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:25</td><td>  19 </td><td> 6  </td><td>put_wind_prop   window property-number value</td>
    <td>WINPUT</td><td><a href="sect15.html#put_wind_prop"><strong>put_wind_prop   </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:26</td><td>  1A </td><td> 6  </td><td>print_form      formatted-table</td>
    <td>PRINTF</td><td><a href="sect15.html#print_form"><strong>print_form      </strong></a></td>
</tr>

<tr><td>     </td><td>   *</td><td>  EXT:27</td><td>  1B </td><td> 6  </td><td>make_menu       number table ?(label)</td>
    <td>MENU</td><td><a href="sect15.html#make_menu"><strong>make_menu       </strong></a></td>
</tr>

<tr><td>     </td><td>    </td><td>  EXT:28</td><td>  1C </td><td> 6  </td><td>picture_table   table</td>
    <td>PICSET</td><td><a href="sect15.html#picture_table"><strong>picture_table   </strong></a></td>
</tr>

</table>

<hr>


<h2 id="14.1">14.1</h2>
<p>This table contains all 119 opcodes and, taken with the dictionary
   in <strong>S</strong> 15, describes exactly what each should do.
   In addition, it lists which opcodes are actually used in the known
   Infocom story files, and documents the Inform assembly language syntax.
</p>

<h2 id="14.2">14.2</h2>
<p>Formally, it is illegal for a game to contain an opcode
   not specified for its version.  An interpreter should normally halt with
   a suitable message.
</p>

<h2 id="14.2.1">14.2.1</h2>
<p>However, extended opcodes in the range EXT:29 to EXT:255
   should be simply ignored (perhaps with a warning message somewhere
   off-screen).
</p>

<h2 id="14.2.2">14.2.2</h2>
<p><strong>***</strong>
   EXT:11 and EXT:12 are opcodes newly added to Standard 1.0
   and which can be generated in code compiled by Inform 6.12 or later.
   EXT:13 to EXT:15, and EXT:29 to EXT:127, are reserved for future versions
   of this document to specify.
</p>

<h2 id="14.2.3">14.2.3</h2>
<p>Designers who wish to create their own "new" opcodes, for one
   specific game only, are asked to use opcode numbers in the range EXT:128 to
   EXT:255.  It is easy to modify Inform to name and assemble such opcodes. 
   (Of course the game will then have to be circulated with a suitably modified
   interpreter to run it.)
</p>

<h2 id="14.2.4">14.2.4</h2>
<p>Interpreter-writers should ideally make this easy by providing a
   routine which is called if EXT:128 to EXT:255 are found, so that
   the minimum possible modification to the interpreter is needed.
</p>

<hr>

<h2 id="reading">Reading the opcode tables</h2>
<p>The two columns "St" and "Br" (store and branch) mark whether an
   instruction stores a result in a variable, and whether it must provide a
   label to jump to, respectively.
</p>

<p>The "Opcode" is written <strong>TYPE:Decimal</strong> where the <strong>TYPE</strong>
   is the operand count (2OP, 1OP, 0OP or VAR) or else EXT for two-byte
   opcodes (where the first byte is (decimal) 190).
   The decimal number is the lowest possible decimal opcode value.
   The hex number is the opcode number within each <strong>TYPE</strong>.
</p>

<p>The "V" column gives the Version information.  If nothing is specified, the
   opcode is as stated from Version 1 onwards.  Otherwise, it exists only from
   the version quoted onwards.  Before this time, its use is illegal.  Some
   opcodes change their meanings as the Version increases, and these have more
   than one line of specification.  Others become illegal again, and these are
   marked <strong>[illegal]</strong>.
</p>

<p>In a few cases, the Version is given as "3/4" or some such.  The first
   number is the Version number whose specification the opcode belongs to, and
   the second is the earliest Version in which the opcode is known actually to
   be used in an Infocom-produced story file.  A dash means that it seems
   never to have been used (in any of Versions 1 to 6).
   The notation "5/<strong>*</strong>" means that the opcode was introduced in this
   Standards document long after the Infocom era.
</p>

<p>The table explicitly marks opcodes which do not exist in any version of the
   Z-machine as <strong>------</strong>: in addition, none of the extended set of codes
   after EXT:28 were ever used.
</p>

<hr>

<h2 id="inform">Inform assembly language</h2>
<p>This section documents Inform 6 assembly language, which is richer than
   that of Inform 5.  The Inform 6 assembler can generate every legal
   opcode and automatically sets any consequent header bits (for instance,
   a usage of <strong>set_colour</strong> will set the "colours needed" bit).
</p>

<p>One way to get a picture of Inform assembly language is to compile
   a short program with tracing switched on (using the <strong>-a</strong> or <strong>-t</strong>
   switches).
</p>

<p>1. An Inform statement beginning with an <strong>@</strong> is sent directly to the
   assembler. In the syntax below, <strong>(variable)</strong> and <strong>(result)</strong> must be
   variables (or <strong>sp</strong>, a special variable name available only in assembly
   language, and meaning the stack pointer); <strong>(label)</strong> a label
   (not a routine name).
</p>

<p><strong>(literal-string)</strong> must be literal text in quotation marks "thus".</p>

<p><strong>routine</strong> should be the name of a routine (this assembles to its packed
   address).  Otherwise any Inform constant term (such as <strong>'/'</strong> or
   <strong>'beetle'</strong>) can be given as an operand.
</p>

<p>2. It is optional, but sensible, to place a <strong>-></strong> sign before a
   store-variable.  For example, in
</p>

<pre>
    @mul a 56 -> sp;
</pre>

<p>("multiply variable <strong>a</strong> by 56, and put the result on the stack") the
   <strong>-></strong> can be omitted, but should be included for clarity.
</p>

<p>3. A label to branch to should be prefaced with a question mark <strong>?</strong>,
   as in
</p>

<pre>
    @je a b ?Equal;      ! Branch to Equal if a == b
</pre>

<p>(If the question mark is omitted, the branch is compiled in the short form,
   which will only work for very nearby labels and is very seldom useful
   in code written by hand.)  Note that the effect of any branch
   instruction can be negated using a tilde <strong>~</strong>:
</p>

<pre>
    @je a b ?~Different; ! Branch to Different if a ~= b
</pre>

<p>4. Labels are assembled using full stops:

<pre>
    .MyLabel;
</pre>

<p>All branches must be to such a label within the same routine.  (The
   Inform assembler imposes the same-routine restriction.)
</p>

<p>5. Most operands are assembled in the obvious way: numbers and constant
   values (like characters) as numbers, variables as variables, <strong>sp</strong> as
   the value on top of the stack.  There are two exceptions.  "Call"
   opcodes expect as first operand the name of a routine to call:
</p>

<pre>
    @call_1n MyRoutine;
</pre>

<p>but one can also give an indirect address, as a constant or variable,
   using square brackets:
</p>

<pre>
    @call_1n [x];        ! Call routine whose address is in x
</pre>

<p>Secondly, seven Z-machine opcodes access variables but by their
   numbers: thus one should write, say, the constant 0 instead of the
   variable <strong>sp</strong>.  This is inconvenient, so the Inform assembler
   accepts variable names instead.  The operands affected are those
   marked as <strong>(variable)</strong> in the syntax chart; Inform translates
   the variable name as a "small constant" operand with that
   variable's number as value.  The affected opcodes are:
</p>

<pre>
    inc,  dec,  inc_chk,  dec_chk,  store,  pull,  load.
</pre>

<p>This is useful, but there is another possibility, of genuinely
   giving a variable operand.  The Inform notation for this involves
   square brackets again:
</p>

<pre>
    @inc frog;          ! Increment var "frog"
    @inc [frog];        ! Increment var whose number is in "frog"
</pre>

<p>Infocom story files often use such instructions.</p>

<p>6. The Inform assembler is also written with possible extensions
   to the Z-machine instruction set in mind.  (Of course these can only
   work if a customised interpreter is used.)  Simply give a specification
   in double-quotes where you would normally give the opcode name.
   For example,
</p>

<pre>
    @"1OP:4S" 34 -> i;
    @get_prop_len 34 -> i;
</pre>

<p>are equivalent instructions, since <strong>get_prop_len</strong> is instruction 4
   in the 1OP (one-operand) set, and is a Store opcode.  The syntax is:
</p>

<pre>
    "  0OP       :  decimal-number  flags  "        (range 0 to 15)
       1OP                                                 0    15
       2OP                                                 0    15
       VAR                                                 32   63
       VAR_LONG                                            32   63
       EXT                                                 0    255
       EXT_LONG                                            0    255
</pre>

<p>(<strong>EXT_LONG</strong>
   is a logical possibility but has not been used in the Z-machine
   so far: the assembler provides it in case it might be useful in future.)
   The possible flags are:
</p>

<pre>
       S    Store opcode
       B    Branch opcode
       T    Text in-line instead of operands
            (as with "print" and "print_ret")
       I    "Indirect addressing": first operand is a (variable)
       Fnn  Set bit nn in Flags 2 (signalling to the interpreter that an
            unusual feature has been called for): the number is in decimal
</pre>

<p>For example,</p>

<pre>
    "EXT:128BSF14"
</pre>

<p>is an exotic new opcode, number 128 in the extended range, which is
   both Branch and Store, and the assembly of which causes bit 14 to
   be set in "Flags 2".  See <strong>S</strong> 14.2 below for rules on how to number
   newly created opcodes.
</p>

<hr>

<h2 id="remarks">Remarks</h2>
<p>The opcodes EXT:5 to EXT:8 were very likely in Infocom's own Version 5
   specification (documentary records of which are lost): they seem to have
   been partially implemented in existing Infocom interpreters, but do not
   occur in any existing Version 5 story file.  They are here left
   unspecified.
</p>

<p>The notation "5/3" for <strong>sound_effect</strong> is because this plainly
   Version 5 feature was used also in one solitary Version 3 game,
   'The Lurking Horror' (the sound version of which was the last Version 3
   release, in September 1987).
</p>

<p>The 2OP opcode 0 was possibly intended for setting break-points
   in debugging (and may be used for this again).  It was not <strong>nop</strong>.
</p>

<p><strong>read_mouse</strong> and <strong>make_menu</strong> are believed to have been used only in
   'Journey' (based on a check of 11 Version 6 story files).
</p>
<p><strong>picture_table</strong> is used once by 'Shogun' and several times by
   'Zork Zero'.</p>

<hr>

<p>
  <a href="index.html">Contents</a> / 
  <a href="preface.html">Preface</a> /
  <a href="overview.html">Overview</a>
</p>

<p>Section
  <a href="sect01.html">1</a> / <a href="sect02.html">2</a> /
  <a href="sect03.html">3</a> / <a href="sect04.html">4</a> /
  <a href="sect05.html">5</a> / <a href="sect06.html">6</a> /
  <a href="sect07.html">7</a> / <a href="sect08.html">8</a> /
  <a href="sect09.html">9</a> / <a href="sect10.html">10</a> /
  <a href="sect11.html">11</a> / <a href="sect12.html">12</a> /
  <a href="sect13.html">13</a> / <a href="sect14.html">14</a> /
  <a href="sect15.html">15</a> / <a href="sect16.html">16</a>
</p>

<p>Appendix
  <a href="appa.html">A</a> / <a href="appb.html">B</a> /
  <a href="appc.html">C</a> / <a href="appd.html">D</a> /
  <a href="appe.html">E</a> / <a href="appf.html">F</a>
</p>

<hr>

</body>
</html>
